<?xml version="1.0" encoding="UTF-8"?>
<ui:decorate xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://xmlns.jcp.org/jsf/html"
             xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
             template="/templates/docsBar.xhtml"
             xmlns:p="http://primefaces.org/ui"
             xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:outputStylesheet name="sheet/createSheet.css"></h:outputStylesheet>

    <h:body>
        <div class="container">
            <div class="jcc">
                <h2>CriaÃ§Ã£o de Personagem ðŸ§™</h2>
            </div>
            <div class="card">
                <p:tooltip/>

                <h:form id="formRegSheet">
                    <p:messages id="messages" closable="true">
                        <p:autoUpdate/>
                    </p:messages>


                    <div class="row mt-2">
                        <div class="col">
                            <div class="p-field p-col-12 p-md-4">
                                <p:outputLabel value="Nome" for="nameSheet" />
                                <p:inputText 
                                    id="nameSheet" 
                                    value="#{sheetController.sheet.name}" 
                                    required="true" 
                                    requiredMessage="Insira nome do personagem"
                                />
                            </div>
                        </div>
                    </div>
                    <div class="r mt-2">
                        <div class="col-5">
                            <div class="p-field">
                                <p:outputLabel value="RaÃ§a" for="selectRace" />
                                <p:selectOneMenu 
                                    value="#{sheetController.sheet.race}" 
                                    id="selectRace" required="true" 
                                    requiredMessage="Insira a raÃ§a do personagem">
                                    <f:selectItem itemLabel="Escolha uma raÃ§a" noSelectionOption="true"/>
                                    <f:selectItems value="#{sheetBean.races}" />
                                </p:selectOneMenu>
                            </div>
                        </div>
                        <div class="col-5">
                            <div class="p-field">
                                <p:outputLabel value="Idade" for="age" styleClass="p-d-block"/>
                                <p:inputText 
                                    id="age" maxlength="5" 
                                    required="true" 
                                    value="#{sheetController.sheet.age}" 
                                    converterMessage="SÃ³ nÃºmeros"
                                    requiredMessage="Insira a idade do personagem atÃ© 99999"
                                    />       
                                <p:message for="age"/>
                            </div>
                        </div>
                    </div>
                    <div class="r mt-2">
                        <div class="col-5">
                            <div class="p-field">
                                <p:outputLabel value="Classe" for="selectClasse" styleClass="p-d-block"/>
                                <p:selectOneMenu 
                                    value="#{sheetController.sheet.klass}" 
                                    id="selectClasse" 
                                    required="true"
                                    requiredMessage="Insira a classe do seu personagem"
                                >
                                    <f:selectItem itemLabel="Escolha uma raÃ§a"  noSelectionOption="true"/>
                                    <f:selectItems value="#{sheetBean.klasses}" />
                                </p:selectOneMenu>
                            </div>
                        </div>
                        <div class="col-5">
                            <div class="p-field">
                                <p:outputLabel value="DescriÃ§Ã£o" for="desc" styleClass="p-d-block" />
                                <p:inputText 
                                    id="desc" 
                                    value="#{sheetController.sheet.description}" 
                                    required="true"
                                    requiredMessage="Insira uma descriÃ§Ã£o para seu personagem"
                                />
                            </div>
                        </div>
                    </div>
                    <div class="r mt-2">
                        <div class="col-5">
                            <div class="p-field">
                                <p:outputLabel value="Charme(0 - 100)" for="charm" styleClass="p-d-block"/>
                                <p:inputText 
                                    converterMessage="SÃ³ nÃºmeros" 
                                    required="true" 
                                    id="charm" 
                                    value="#{sheetController.sheet.skill.charm}"
                                    requiredMessage="Insira o charme do seu personagem (0 - 100)"
                                    >
                                    <f:validateLongRange maximum="100" minimum="0" />
                                </p:inputText>
                            </div>
                        </div>
                        <div class="col-5">
                            <div class="p-field">
                                <p:outputLabel value="Destreza(0 - 100)" for="dexterity" styleClass="p-d-block"/>
                                <p:inputText 
                                    converterMessage="SÃ³ nÃºmeros" 
                                    required="true" 
                                    id="dexterity" 
                                    value="#{sheetController.sheet.skill.dexterity}"
                                    requiredMessage="Insira a destreza do seu personagem (0 - 100)"
                                    >
                                    <f:validateLongRange maximum="100" minimum="0" />
                                </p:inputText>
                            </div>
                        </div>
                    </div>
                    <div class="r mt-2">
                        <div class="col-5">
                            <div class="p-field">
                                <p:outputLabel value="InteligÃªncia(0 - 100)" for="intelligence" styleClass="p-d-block"/>
                                <p:inputText 
                                    converterMessage="SÃ³ nÃºmeros" 
                                    required="true" 
                                    id="intelligence" 
                                    value="#{sheetController.sheet.skill.intelligence}"
                                    requiredMessage="Insira a inteligÃªncia do seu personagem (0 - 100)">
                                    <f:validateLongRange maximum="100" minimum="0" />
                                </p:inputText>
                            </div>
                        </div>
                        <div class="col-5">
                            <div class="p-field">
                                <p:outputLabel value="ForÃ§a(0 - 100)" for="strength" styleClass="p-d-block"/>
                                <p:inputText 
                                    converterMessage="SÃ³ nÃºmeros" 
                                    required="true" 
                                    id="strength" 
                                    value="#{sheetController.sheet.skill.strong}"
                                    requiredMessage="Insira a forÃ§a do seu personagem (0 - 100)">
                                    <f:validateLongRange maximum="100" minimum="0" />
                                </p:inputText>
                            </div>
                        </div>
                    </div>
                    <hr/>
                    <h3>Minhas Armas</h3>
                    <h:panelGroup id="toolsDiv">
                        <ui:repeat var="tool"  value="#{sheetController.sheet.tools}" varStatus="toolStatus">
                            <div class="r mt-2">
                                <div class="col-4">
                                    <div class="p-field">
                                        <p:outputLabel value="Tipo da Arma" for="toolKind" styleClass="p-d-block"/>
                                        <p:selectOneMenu required="true" value="#{tool.kind}" 
                                                         id="toolKind" 
                                                         requiredMessage="Insira o tipo da nova arma">
                                            <f:selectItem itemLabel="Escolha um tipo de arma" noSelectionOption="true"/>
                                            <f:selectItems value="#{sheetBean.toolKinds}" />
                                        </p:selectOneMenu>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="p-field">
                                        <p:outputLabel value="Nome da Arma" for="toolName" styleClass="p-d-block"/>
                                        <p:inputText value="#{tool.name}" required="true" id="toolName"  requiredMessage="Insira o nome da nova arma"/>
                                    </div>
                                </div>
                                <div class="col-3">
                                    <div class="p-field">
                                        <p:outputLabel value="Dano(0 - 100) da Arma" for="toolDamage" styleClass="p-d-block"/>
                                        <p:inputText converterMessage="SÃ³ nÃºmeros" required="true" id="toolDamage" value="#{tool.damage}" requiredMessage="Insira o dano da nova arma"> 
                                            <f:validateLongRange maximum="100" minimum="0" />
                                        </p:inputText>
                                    </div>
                                </div>

                                <div class="col-1">
                                    <div class="c">
                                        <div class="jcc">
                                            <p:commandButton 
                                                icon="pi pi-times" 
                                                styleClass="rounded-button ui-button-danger ui-button-flat" 
                                                action="#{editSheetController.removeTool(toolStatus.index)}" 
                                                title="Deletar"
                                                type="submit"
                                                update="@form" 
                                                >
                                            </p:commandButton>                                          
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </ui:repeat>

                        <hr/>
                        
                    </h:panelGroup>

                    <div class="c">
                        <div class="jcc">
                            <p:commandButton 
                                styleClass="ui-button-warning"
                                value="Adicionar Nova Arma"
                                action="#{sheetController.addTool}" 
                                title="Adicionar Nova Arma"
                                update="toolsDiv"
                                >
                            </p:commandButton>
                        </div>
                    </div>

                    <div class="r mt-2">
                        <div class="jcc">
                            <p:commandButton 
                                icon="pi pi-check" 
                                value="Salvar"
                                action="#{sheetController.save()}" 
                                title="Salvar"
                                update="@all"
                                >
                            </p:commandButton>
                        </div>
                    </div>

                </h:form>
            </div>
            <p:dialog id="createdSheetModal" widgetVar="createdSheetModal">
                <h3>Ficha criada com sucesso!</h3>
                <p:commandButton value="Ver minhas fichas" action="/docs/index.xhtml?faces-redirect=true" class="custom"></p:commandButton>
            </p:dialog>
        </div>
    </h:body>

</ui:decorate>